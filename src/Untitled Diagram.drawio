<mxfile host="app.diagrams.net" modified="2021-10-08T12:39:43.106Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36" etag="FstFr7Ne47VgY_HdA6aw" version="15.3.8" type="github">
  <diagram id="KefcSTh8LU217DtaOy7r" name="Page-1">
    <mxGraphModel dx="8066" dy="2841" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="LtVPb9jL59xOHaWL_HOs-79" value="" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=#0000FF;align=left;" parent="1" vertex="1">
          <mxGeometry x="-4180" y="-210" width="6700" height="4260" as="geometry" />
        </mxCell>
        <mxCell id="7nwJAHShgFqfV8WITLV7-1" value="水银样本任务流程图" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;pointerEvents=0;fontSize=35;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="-280" y="-30" width="400" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-5" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="7nwJAHShgFqfV8WITLV7-2" target="hdSKTdFJiRucH8Rsu3lH-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-7" value="函数调用" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=16;" parent="hdSKTdFJiRucH8Rsu3lH-5" vertex="1" connectable="0">
          <mxGeometry x="-0.4741" relative="1" as="geometry">
            <mxPoint y="8" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="7nwJAHShgFqfV8WITLV7-2" value="sampleupload/views.save_file_uploaded_info_new()" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;" parent="1" vertex="1">
          <mxGeometry x="140" y="158" width="530" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-2" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-1" target="7nwJAHShgFqfV8WITLV7-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-3" value="rpc调用" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=16;" parent="hdSKTdFJiRucH8Rsu3lH-2" vertex="1" connectable="0">
          <mxGeometry x="-0.4" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-1" value="&lt;div&gt;cloudkilling的start_upload_processes.py会将特定目录的文件入库（cloudkilling和uploadapp部署在同一台机器）&lt;/div&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;1、&lt;span style=&quot;font-size: 24px&quot;&gt;将样本放入异步上传目录&lt;br style=&quot;font-size: 24px&quot;&gt;2、将样本放到缓存服务器，将md5信息，ip信息记录到&lt;/span&gt;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace ; font-size: 24px&quot;&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_sample_cache&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace ; font-size: 24px&quot;&gt;表&lt;/span&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;fillColor=none;fontColor=#000000;align=left;fontStyle=0" parent="1" vertex="1">
          <mxGeometry x="-616.25" y="92" width="610" height="195" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-9" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-4" target="hdSKTdFJiRucH8Rsu3lH-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-4" value="save_file_info" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;" parent="1" vertex="1">
          <mxGeometry x="290" y="270" width="230" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-12" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-8" target="hdSKTdFJiRucH8Rsu3lH-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-8" value="创建样本任务，设置任务开始时间&lt;br&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_sample_elapsed_time&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;" parent="1" vertex="1">
          <mxGeometry x="236.88" y="380" width="340" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-10" value="保存数据，定时同步到datasync库&lt;br&gt;&lt;font color=&quot;#ff6666&quot;&gt;d_virusfilter_result&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;" parent="1" vertex="1">
          <mxGeometry x="-390" y="490" width="370" height="95" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-15" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-11" target="hdSKTdFJiRucH8Rsu3lH-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-21" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-11" target="hdSKTdFJiRucH8Rsu3lH-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-11" value="判断file_name" style="rhombus;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=16;" parent="1" vertex="1">
          <mxGeometry x="350" y="490" width="113.75" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-13" value="函数调用" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=16;" parent="1" vertex="1" connectable="0">
          <mxGeometry x="405" y="340" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-17" value="&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;file_name startswith(ksup、kspf)&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;pointerEvents=0;fontSize=16;" parent="1" vertex="1">
          <mxGeometry x="20" y="500" width="250" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-18" value="&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;visit_count_file_name startswith(ksup、kspf)&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;pointerEvents=0;fontSize=16;" parent="1" vertex="1">
          <mxGeometry x="20" y="540" width="340" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-23" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=16;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-20" target="hdSKTdFJiRucH8Rsu3lH-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-20" value="文件样本路径，机器ip放到缓存&lt;br&gt;有效期3天&lt;br&gt;&lt;font color=&quot;#00cc00&quot;&gt;key=store_path_and_server_ip-{md5}&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;" parent="1" vertex="1">
          <mxGeometry x="205" y="620" width="400" height="140" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-38" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-22" target="hdSKTdFJiRucH8Rsu3lH-35" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-41" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-22" target="hdSKTdFJiRucH8Rsu3lH-40" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-22" value="创建/获取样本任务&lt;br&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_sample_task&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;" parent="1" vertex="1">
          <mxGeometry x="220" y="820" width="370" height="95" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-153" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-35" target="hdSKTdFJiRucH8Rsu3lH-152" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-35" value="创建主流程处理任务&lt;br&gt;add_main_flow_handle_task（handle/views.py）&lt;br&gt;1、add_sample_flow_task组装数据" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="610" y="985.5" width="750" height="92" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-36" value="&lt;span style=&quot;font-size: 22px&quot;&gt;不走鉴定流程的情况&lt;br style=&quot;font-size: 22px&quot;&gt;create_av_and_detector_task = False&lt;br style=&quot;font-size: 22px&quot;&gt;1、其他PE、坏包、加密包不处理&lt;br style=&quot;font-size: 22px&quot;&gt;2、文件大于300M不走鉴定流程&lt;br style=&quot;font-size: 22px&quot;&gt;3、&lt;/span&gt;&lt;span style=&quot;font-size: 22px&quot;&gt;VFILE&lt;/span&gt;&lt;span style=&quot;font-size: 22px&quot;&gt;渠道的样本不需要走鉴定等流程，只保存样本&lt;br&gt;&lt;/span&gt;4、白样本收集渠道直接提白，第二天回扫&lt;br&gt;5、源服务端下载保护白渠道、海外样本鉴定（白）&lt;br style=&quot;font-size: 22px&quot;&gt;&lt;span style=&quot;font-size: 22px&quot;&gt;&lt;br style=&quot;font-size: 22px&quot;&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;fontFamily=Helvetica;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="-460" y="720" width="510" height="237.5" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-49" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=22;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-40" target="hdSKTdFJiRucH8Rsu3lH-48" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-40" value="创建鉴定器、杀软扫描器任务add_av_and_detector_task&lt;br style=&quot;font-size: 24px&quot;&gt;往&lt;font color=&quot;#ff6666&quot; style=&quot;font-size: 24px&quot;&gt;t_detector_combine_result&lt;/font&gt;表插入鉴定结果初始数据" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="-267" y="1145" width="650" height="130" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-44" value="&lt;span style=&quot;color: rgb(0 , 0 , 0) ; font-family: &amp;#34;helvetica&amp;#34; ; font-size: 22px ; font-style: normal ; font-weight: 400 ; letter-spacing: normal ; text-align: left ; text-indent: 0px ; text-transform: none ; word-spacing: 0px ; background-color: rgb(248 , 249 , 250) ; display: inline ; float: none&quot;&gt;create_av_and_detector_task =true&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=22;fontFamily=Helvetica;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="-40" y="970" width="390" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-59" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=22;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-48" target="hdSKTdFJiRucH8Rsu3lH-76" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="73" y="1840" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-60" value="&lt;span style=&quot;text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;task_flowtype=2&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;&lt;font face=&quot;helvetica&quot;&gt;异步&lt;/font&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=22;fontFamily=Helvetica;fontColor=#000000;" parent="hdSKTdFJiRucH8Rsu3lH-59" vertex="1" connectable="0">
          <mxGeometry x="-0.2667" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-125" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-48" target="hdSKTdFJiRucH8Rsu3lH-68" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-537" y="1660" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-126" value="&lt;span style=&quot;font-size: 22px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;task_flowtype=1&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 22px ; text-align: left ; background-color: rgb(248 , 249 , 250)&quot;&gt;&lt;font face=&quot;helvetica&quot;&gt;同步&lt;/font&gt;&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=24;fontFamily=Helvetica;fontColor=#000000;" parent="hdSKTdFJiRucH8Rsu3lH-125" vertex="1" connectable="0">
          <mxGeometry x="-0.3205" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-48" value="同步/异步" style="rhombus;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;align=center;" parent="1" vertex="1">
          <mxGeometry x="-13.25" y="1440" width="142.5" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-70" value="&lt;span style=&quot;color: rgb(0, 0, 0); font-family: helvetica; font-size: 35px; font-style: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(248, 249, 250); display: inline; float: none;&quot;&gt;异步-回扫流程&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=35;fontFamily=Helvetica;fontColor=#000000;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="490" y="1570" width="258" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-79" value="此处省略了不同数据来源调用不同方法的具体逻辑" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#FF33FF;" parent="1" vertex="1">
          <mxGeometry x="299" y="927.5" width="249" height="100" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-80" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;fontFamily=Helvetica;fontSize=35;fontColor=#FF33FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="7nwJAHShgFqfV8WITLV7-1" target="7nwJAHShgFqfV8WITLV7-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-84" value="&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;&lt;b&gt;&lt;font style=&quot;font-size: 35px&quot;&gt;同步-正常流程&lt;/font&gt;&lt;/b&gt;&lt;/span&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=35;fontColor=#FF33FF;" parent="1" vertex="1">
          <mxGeometry x="-660" y="1610" width="257" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-86" value="&lt;span style=&quot;color: rgb(0, 0, 0); font-family: helvetica; font-size: 35px; font-style: normal; letter-spacing: normal; text-align: left; text-indent: 0px; text-transform: none; word-spacing: 0px; background-color: rgb(248, 249, 250); display: inline; float: none;&quot;&gt;新增主流程处理任务&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=35;fontFamily=Helvetica;fontColor=#000000;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="990" y="927.5" width="340" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-91" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=35;fontColor=#FF33FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-87" target="hdSKTdFJiRucH8Rsu3lH-89" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-87" value="主流程处理任务流转(halder/move_sample_flow_task_for_cache.py)&lt;br&gt;1、从队列&lt;font color=&quot;#00cc00&quot;&gt;zset key =sample_flow_data_running&lt;/font&gt;获取任务数据添加到task[]" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="1500" y="1242.5" width="840" height="95" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-92" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=35;fontColor=#FF33FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-89" target="hdSKTdFJiRucH8Rsu3lH-90" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-89" value="2、批量操作把原来队列的数据移到&lt;font color=&quot;#00cc00&quot;&gt;zset key =sample_flow_data_running&lt;/font&gt;样本处理中的队列并把原来队列删除,同时把任务添加到task[]，对于那些没有获取到值的数据移除队列，（并把对应数据，设置过期时间30s自动删除）" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="1500" y="1400" width="840" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-94" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=35;fontColor=#FF33FF;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-90" target="hdSKTdFJiRucH8Rsu3lH-93" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-90" value="task[]处理后变成流程集合process_list,通过调用move函数，&lt;br&gt;1、handle_sample_signature处理样本特征，apk文件会根据md5查询&lt;font color=&quot;#0000ff&quot;&gt;t_mobile_repack&lt;/font&gt;表不存在跳过。&lt;br&gt;2、repack_src_sign_md5/sign_md5查询手机云特征表&lt;font color=&quot;#0000ff&quot;&gt;t_sample_signature_mobile&lt;/font&gt;&lt;br&gt;3、提取样本特征保持到相应的表（小于2G的样本，超过2G保存）" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="1500" y="1588" width="840" height="135" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-117" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-93" target="hdSKTdFJiRucH8Rsu3lH-116" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-93" value="根据样本的类型不同保存到不同的特征表&lt;br&gt;&lt;font color=&quot;#0000ff&quot;&gt;1、t_sample_signature文件云特征表&lt;br&gt;2、t_sample_signature_pak压缩包特征表&lt;br&gt;3、t_sample_signature_mobile手机云特征表&lt;br&gt;4、t_sample_signature_no_signature无特征的特征表&lt;br&gt;5、t_sample_signature_npe非PE特征表&lt;br&gt;6、t_sample_signature_publish文件云特征发布表&lt;br&gt;7、t_sample_signature_publish_mobile_pc手机云特征发布表(PC端)&lt;br&gt;8、t_sample_signature_publish_mobile手机云特征发布表(移动端，仅特征码)&lt;br&gt;9、t_sample_signature_publish_mobile_detail手机云特征发布表(移动端，仅详情)&lt;br&gt;10、t_sample_signature_publish_mobile_overseas_detail手机云特征发布表(移动端海外服务器，仅详情)&lt;br&gt;11、t_sample_signature_publish_npe文件云特征发布表 非PE特征&lt;br&gt;12、t_sample_signature_error3.0特征错误历史&lt;br&gt;13、t_false_md5_apptype_sign_prepare apptype预发布表（添加去误报任务）&lt;br&gt;14、t_false_md5_sign_prepare 去误报md5预发布表（添加signmd5去误报任务）&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="1500" y="1770" width="840" height="480" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-95" value="后续" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.4;arrowSize=0.4;rounded=0;fontSize=22;align=left;hachureGap=4;" parent="1" vertex="1">
          <mxGeometry x="1400" y="1261" width="80" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-98" value="&lt;span style=&quot;font-size: 24px&quot;&gt;scan_server_auto_adjust.py&lt;font style=&quot;font-size: 24px&quot;&gt;扫描服务器自动调整？&lt;/font&gt;&lt;br&gt;1、充分利用空闲机器，协助任务堆积的任务&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;fontFamily=Helvetica;fontColor=#000000;labelBackgroundColor=none;fillColor=#E6D0DE;" parent="1" vertex="1">
          <mxGeometry x="-1960" y="2650" width="810" height="190" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-100" value="&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;span&gt; &lt;/span&gt;&amp;nbsp; &lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;&lt;span style=&quot;white-space: pre&quot;&gt; &lt;/span&gt;&lt;/span&gt;&lt;b&gt;文件上报服务（uploadapp）&lt;/b&gt;&lt;br&gt;&lt;/font&gt;&lt;h4 id=&quot;id-文件上报+入库服务-接收上报的普通文件（/uploadsample接口）&quot; style=&quot;margin: 10px 0px 0px ; padding: 0px ; line-height: 1.42857 ; letter-spacing: -0.003em ; background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font style=&quot;font-size: 24px ; font-weight: normal&quot;&gt;（来源：客户端、人工、样本交换）&lt;/font&gt;&lt;/h4&gt;&lt;h4 id=&quot;id-文件上报+入库服务-接收上报的普通文件（/uploadsample接口）&quot; style=&quot;margin: 10px 0px 0px ; padding: 0px ; line-height: 1.42857 ; letter-spacing: -0.003em ; background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font style=&quot;font-size: 24px ; font-weight: normal&quot;&gt;1、接收上报的普通文件，保存在临时目录，并校验，非法则删除&lt;/font&gt;&lt;/h4&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;2、将zip文件移到特定目录&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;3、去新的文件上报系统拉取样本到指定目录&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;4、解密和unzip解压，解压完移到特定目录&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="-1700" y="30" width="690" height="262" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-108" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;targetPerimeterSpacing=8;entryX=0.5;entryY=0;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;startArrow=none;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-65" target="hdSKTdFJiRucH8Rsu3lH-107" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-267" y="2490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-116" value="结束" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#FF6666;align=center;" parent="1" vertex="1">
          <mxGeometry x="1880" y="2319" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-120" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-118" target="hdSKTdFJiRucH8Rsu3lH-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-118" value="开始" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#97D077;align=center;" parent="1" vertex="1">
          <mxGeometry x="-760" y="143" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-124" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="LtVPb9jL59xOHaWL_HOs-48" target="hdSKTdFJiRucH8Rsu3lH-107" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="665.3800000000001" y="2428.42" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-127" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-320" y="2516" width="860" height="200" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-107" value="1、更新&lt;span style=&quot;color: rgb(255 , 102 , 102)&quot;&gt;t_detector_combine_result&lt;/span&gt;&lt;font style=&quot;font-size: 24px ; background-color: rgb(255 , 255 , 255)&quot;&gt;表created_tasks=true表示已经创建杀软、扫描鉴定流程&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;align=left;" parent="hdSKTdFJiRucH8Rsu3lH-127" vertex="1">
          <mxGeometry width="860" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-110" value="结束" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#FF6666;align=center;" parent="hdSKTdFJiRucH8Rsu3lH-127" vertex="1">
          <mxGeometry x="390" y="130" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-112" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="hdSKTdFJiRucH8Rsu3lH-127" source="hdSKTdFJiRucH8Rsu3lH-107" target="hdSKTdFJiRucH8Rsu3lH-110" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-133" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=#000000;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-132" target="hdSKTdFJiRucH8Rsu3lH-87" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-132" value="开始" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#97D077;align=center;" parent="1" vertex="1">
          <mxGeometry x="1875" y="1120" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-134" value="结束" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#FF6666;align=center;" parent="1" vertex="1">
          <mxGeometry x="940" y="1500" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-138" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-136" target="hdSKTdFJiRucH8Rsu3lH-137" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-136" value="&lt;span style=&quot;font-size: 24px&quot;&gt;run_downloader.py脚本&lt;br style=&quot;font-size: 24px&quot;&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;2、获取鉴定器信息查询的查询&lt;br style=&quot;font-size: 24px&quot;&gt;3、rpc申请鉴定任务&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;apply_detector_tasks()&lt;br style=&quot;font-size: 24px&quot;&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;4、scan_task_redis_manager.py 根据&lt;/span&gt;队列&lt;font style=&quot;font-size: 24px&quot; color=&quot;#00cc00&quot;&gt;id=scanner_id+kcs_scan_task+&lt;/font&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;font color=&quot;#00cc00&quot;&gt;bigfile&lt;/font&gt;，获取队列数据加入到扫描的优先级队列当中&lt;font color=&quot;#00cc00&quot;&gt;id=&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;&lt;font color=&quot;#00cc00&quot;&gt;scanning_queue:&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;&lt;font color=&quot;#00cc00&quot;&gt;kcs_scan_task&lt;/font&gt;&lt;br&gt;5、根据任务中的task，批量下载文件，标记目录完成状态，鉴定器开始扫描&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=#000000;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-2991" y="1613" width="620" height="336" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-143" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-137" target="hdSKTdFJiRucH8Rsu3lH-142" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-137" value="&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;scan_task_reset.py脚本&lt;br&gt;1、查询MongDB库的任务，更新修改时间，任务创建状态，如果已经扫描结束，把数据从&lt;font style=&quot;font-size: 24px&quot; color=&quot;#0000ff&quot;&gt;kcs_scan_task、av_scan_task&lt;/font&gt;表&lt;br&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;备份到&lt;/font&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;font color=&quot;#0000ff&quot;&gt;kcs_scan_task_backup、&amp;nbsp;av_scan_task_backup&lt;/font&gt;表&lt;/font&gt;&lt;br&gt;2、所有鉴定器扫完之后移除已经创建扫描器的队列数据&lt;font style=&quot;font-size: 24px&quot;&gt;id=scanner_id+kcs_scan_task+&lt;/font&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;bigfile&lt;br&gt;&lt;/font&gt;&lt;/font&gt;3、记录&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_log_force_finish_task&lt;/font&gt;任务完成日志&lt;br&gt;4、修改&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_detector_combine_result&lt;/font&gt;表的鉴定结果时间和杀软扫描&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;时间&lt;br&gt;&lt;/span&gt;5、进入总评环节&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace ; font-size: 11.3pt&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-2991" y="1999" width="620" height="360" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-142" target="LtVPb9jL59xOHaWL_HOs-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-2411" y="2513" />
              <mxPoint x="-2411" y="2513" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-142" value="&lt;font style=&quot;font-size: 24px&quot;&gt;server/combine/views.py&lt;br&gt;&lt;/font&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;do_combine_if_av_and_detector_finished（）&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;1、查询已经扫描鉴定完成的记录t_detector_combine_result&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;span&gt;2、汇总流程中的数据结果转成json（&lt;/span&gt;&lt;/font&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_detector_combine_result、t_sample_task、t_virus_sample_task、&lt;/font&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;background-color: rgb(255 , 255 , 255) ; font-size: 24px&quot;&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_virus_sample_big_text、t_detector_result&lt;/font&gt;）&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;3、开始总评mobile_judge.py&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=none;" parent="1" vertex="1">
          <mxGeometry x="-2991" y="2399" width="620" height="280" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-1" value="\" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-144" target="hdSKTdFJiRucH8Rsu3lH-146" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-19" value="N" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LtVPb9jL59xOHaWL_HOs-1" vertex="1" connectable="0">
          <mxGeometry x="0.5681" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-144" value="&lt;div&gt;&lt;div&gt;mobile_judge.py&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&gt;1、judge（）总评入口&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&gt;judge.py kcs_judge&lt;/span&gt;()鉴定器总评入口：根据所有鉴定器结果取得总评分数，得到总分和结果&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;span&gt;2、mobile_safescan/&lt;/span&gt;&lt;/font&gt;judge.py va_judge()杀软总评入口:得到分數、扫描结果等&lt;/div&gt;&lt;div&gt;&lt;span&gt;3、get_combine_score&lt;/span&gt;计算总评分数&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&gt;4、get_combine_result计算总评结果&lt;/span&gt;&lt;/div&gt;&lt;div&gt;5、repair_combine_result&lt;span&gt;修正总评结果&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-2991" y="2929" width="620" height="280" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-149" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-146" target="hdSKTdFJiRucH8Rsu3lH-148" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-156" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-146" target="hdSKTdFJiRucH8Rsu3lH-151" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-146" value="server/combine/views.py&lt;br&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;把总评结果记录到&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_detector_combine_result&lt;/font&gt;表&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-2991" y="3412" width="620" height="100" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-148" target="LtVPb9jL59xOHaWL_HOs-22" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-148" value="&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace ; font-size: 15.0667px ; text-align: left&quot;&gt;总评结果是白或者黑&lt;/span&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=default;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=default;strokeColor=#000000;fillColor=#FFFFFF;align=center;" parent="1" vertex="1">
          <mxGeometry x="-2301" y="3409" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-155" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-151" target="hdSKTdFJiRucH8Rsu3lH-152" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-350" y="3740" />
              <mxPoint x="1570" y="2770" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-151" value="&lt;font style=&quot;font-size: 24px&quot;&gt;server/combine/views.py&lt;br&gt;&lt;/font&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;1、格式化结果把总评结果记录到&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;&lt;font color=&quot;#ff6666&quot;&gt;t_detector_combine_result&lt;/font&gt;表&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;云3结果处理&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;2、最终组装最新的数据重走&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;add_sample_flow_task流程&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-3036" y="3709" width="710" height="198" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-154" value="" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;endArrow=open;startSize=14;endSize=14;sourcePerimeterSpacing=8;targetPerimeterSpacing=8;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-152" target="hdSKTdFJiRucH8Rsu3lH-134" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-152" value="server/view.py&lt;br&gt;1、save_sample_flow_data（）&lt;br&gt;2、把样本流转数据放到redis缓存&lt;font color=&quot;#00cc00&quot;&gt;key=sample_flow_data-{md5}&lt;/font&gt;,有效期3天&lt;br&gt;3、把file_md5保存到redis队列，zadd到&lt;font color=&quot;#00cc00&quot;&gt;name=sample_flow_data_key&lt;/font&gt;的zset&lt;br&gt;4、如果成功没有保存到redis队列，则需要把数据保存到&lt;font color=&quot;#0000ff&quot;&gt;t_sample_flow_task&lt;/font&gt;表&lt;br&gt;5、更新&lt;font color=&quot;#ff6666&quot;&gt;t_sample_elapsed_time&lt;/font&gt;表的combine_end_time时间&lt;br&gt;6、根据md5删除MongDB的&lt;font color=&quot;#0000ff&quot;&gt;sample_handle_task&lt;/font&gt;表的任务，重新插入&lt;br&gt;7、缓存&lt;font style=&quot;font-size: 24px ; background-color: rgb(255 , 255 , 255)&quot;&gt;sample_exists-{md5}6小时，方便其他程序排重&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="605" y="1145" width="750" height="292" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="LtVPb9jL59xOHaWL_HOs-2" target="LtVPb9jL59xOHaWL_HOs-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-11" value="OTHER" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LtVPb9jL59xOHaWL_HOs-7" vertex="1" connectable="0">
          <mxGeometry x="-0.1709" y="2" relative="1" as="geometry">
            <mxPoint x="-4" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="LtVPb9jL59xOHaWL_HOs-2" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-2371" y="2779" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-12" value="UNKNOWN、OLE、MSI" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LtVPb9jL59xOHaWL_HOs-9" vertex="1" connectable="0">
          <mxGeometry x="-0.1219" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="LtVPb9jL59xOHaWL_HOs-2" target="hdSKTdFJiRucH8Rsu3lH-144" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-14" value="APK" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LtVPb9jL59xOHaWL_HOs-10" vertex="1" connectable="0">
          <mxGeometry x="-0.372" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-2" value="根据样本类型" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=default;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=default;strokeColor=#000000;fillColor=#FFFFFF;align=center;" parent="1" vertex="1">
          <mxGeometry x="-2781" y="2729" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="LtVPb9jL59xOHaWL_HOs-6" target="LtVPb9jL59xOHaWL_HOs-16" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-3146" y="3229" />
              <mxPoint x="-2681" y="3229" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-6" value="&lt;span style=&quot;text-align: left&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;mobile_judge.py&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;span&gt;pc_judge()&lt;br&gt;......&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontColor=#000000;fontSize=24;" parent="1" vertex="1">
          <mxGeometry x="-3291" y="2725.25" width="290" height="107.5" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-15" value="&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;根据配置参数&lt;/font&gt;IS_BETA走不一样的测试的鉴定流程&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;mobile_judge_beta()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;npe_judge_beta()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;pc_judge_beta()&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;总评完回把云3结果记录在&lt;font color=&quot;#ff6666&quot;&gt;t_test_run_data&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-3771" y="3217" width="620" height="184" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="LtVPb9jL59xOHaWL_HOs-16" target="LtVPb9jL59xOHaWL_HOs-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-18" value="Y" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="LtVPb9jL59xOHaWL_HOs-17" vertex="1" connectable="0">
          <mxGeometry x="0.0939" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-16" value="&lt;pre style=&quot;font-family: &amp;quot;dejavu sans mono&amp;quot;, monospace; font-size: 11.3pt;&quot;&gt;IS_BETA?&lt;/pre&gt;" style="rhombus;whiteSpace=wrap;html=1;labelBackgroundColor=default;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=default;strokeColor=#000000;fillColor=#FFFFFF;align=center;" parent="1" vertex="1">
          <mxGeometry x="-2781" y="3259" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-25" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontFamily=Helvetica;fontSize=24;fontColor=default;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="LtVPb9jL59xOHaWL_HOs-21" target="LtVPb9jL59xOHaWL_HOs-16" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-2681" y="3229" as="targetPoint" />
            <Array as="points">
              <mxPoint x="-2246" y="3229" />
              <mxPoint x="-2681" y="3229" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-21" value="&lt;span style=&quot;text-align: left;&quot;&gt;mobile_judge.py&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;&quot;&gt;npe_judge()&lt;br&gt;......&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=none;fontSize=24;fontColor=#000000;fontStyle=0;fontFamily=Helvetica;" parent="1" vertex="1">
          <mxGeometry x="-2371" y="2739" width="250" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-22" value="server/view.py&lt;br&gt;1、根据md5删除MongDB的&lt;font color=&quot;#0000ff&quot;&gt;sample_handle_task&lt;/font&gt;表原来的任务&lt;br&gt;2、重新插入最新的总评结果、和病毒名称等信息的任务" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;" parent="1" vertex="1">
          <mxGeometry x="-2406" y="3559" width="410" height="132" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-29" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-10" y="1190" as="sourcePoint" />
            <mxPoint x="40" y="1140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-31" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;fontFamily=Helvetica;fontSize=24;fontColor=default;entryX=0;entryY=0.5;entryDx=0;entryDy=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-36" target="hdSKTdFJiRucH8Rsu3lH-22" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="40" y="940" as="sourcePoint" />
            <mxPoint x="90" y="890" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-51" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="LtVPb9jL59xOHaWL_HOs-32" target="LtVPb9jL59xOHaWL_HOs-50" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-32" value="&lt;font&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;&lt;font face=&quot;microsoft yahei ui&quot; style=&quot;font-size: 24px&quot;&gt;scantaskapplier.py&lt;br&gt;&lt;/font&gt;1、调用&lt;span style=&quot;font-family: &amp;#34;microsoft yahei ui&amp;#34;&quot;&gt;basescantaskapplier.py 的run()&lt;/span&gt;&lt;br&gt;2、&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;apply_samples()-&amp;gt;&lt;/span&gt;rpc获取杀软扫描任务a&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;pply_scanner_tasks&lt;/span&gt;()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;apply_scanner_tasks_with_cache&lt;/font&gt;&lt;/span&gt;根据队列&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;id=scanner_id+&lt;/font&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255)&quot;&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;av_scan_task&lt;/font&gt;&lt;/span&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;+&lt;/font&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;bigfile&lt;/font&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;，获取队列数据加入到扫描的优先级队列当中&lt;/span&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;id=&lt;/font&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;scanning_queue:&lt;/font&gt;&lt;span style=&quot;color: rgb(0 , 204 , 0) ; background-color: rgb(255 , 255 , 255)&quot;&gt;av_scan_task&lt;/span&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;3、把获取到的任务数据对应的样本下载的样本复制到各个杀软的扫描目录&lt;span style=&quot;font-family: &amp;#34;microsoft yahei ui&amp;#34;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;4、&lt;/font&gt;&lt;/span&gt;各个杀软扫描目录，对样本进行扫描&lt;br&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;5、&lt;/font&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px ; font-family: &amp;#34;microsoft yahei ui&amp;#34;&quot;&gt;scanresultsaver.py扫描结果处理&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;查杀完成后，从扫描结果目录读取已经扫描的批次，杀软，扫描病毒信息，然后保存结果&lt;/span&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1960" y="1628" width="820" height="360" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-39" value="鉴定器重置流程" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=default;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="-2823" y="1370" width="284" height="40" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-40" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-1060" y="1785" width="140" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-128" value="" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;flipH=1;notch=0;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=none;" parent="LtVPb9jL59xOHaWL_HOs-40" vertex="1">
          <mxGeometry width="140" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-35" value="消费队列" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=24;fontFamily=Helvetica;fontColor=default;" parent="LtVPb9jL59xOHaWL_HOs-40" vertex="1">
          <mxGeometry x="5" y="25" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-47" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-827" y="1640" width="860" height="728.42" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-68" value="&lt;div&gt;优先级大于0的直接创建杀软扫描任务和鉴定器任务，没有优先级的需要判断MongDB中的&lt;font color=&quot;#0000ff&quot;&gt;kcs_scan_task、av_scan_task&lt;/font&gt;任务数是否都小于10万，是才创建杀软扫描任务和鉴定器任务，否则不创建任务，更新&lt;font color=&quot;#ff3333&quot;&gt;t_sample_elapsed_time &lt;/font&gt;表的错误码9001001&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;align=left;" parent="LtVPb9jL59xOHaWL_HOs-47" vertex="1">
          <mxGeometry width="860" height="127.18463079555181" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-64" value="" style="group" parent="LtVPb9jL59xOHaWL_HOs-47" vertex="1" connectable="0">
          <mxGeometry y="127.18" width="860" height="510" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-62" value="&lt;font face=&quot;helvetica&quot;&gt;create_scanner_tasks&lt;/font&gt;(safescan\manager.py)&lt;br&gt;create_scanner_tasks_with_sync_to_queue&lt;br&gt;1、删除病毒样本任务（delete&lt;font color=&quot;#ff3333&quot;&gt; t_virus_sample_task/t_virus_sample_big_text&lt;/font&gt; by md5）&lt;br&gt;2、获取所有的杀软id&lt;br&gt;3、（忽略没有杀软的情况）create_tasks_with_sync_to_queues先根据md5移除再创建扫描任务数据保存到MongDB的&lt;span style=&quot;font-family: &amp;#34;helvetica&amp;#34;&quot;&gt;&lt;font color=&quot;#0000ff&quot;&gt;av_scan_task&lt;/font&gt;&lt;/span&gt;表&lt;br&gt;4、把扫描任务同步到Redis优先级队列&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;id=scanner_id+av_scan_task+&lt;/font&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-size: 24px&quot;&gt;&lt;font color=&quot;#00cc00&quot;&gt;bigfile&lt;/font&gt;&lt;/span&gt;&lt;br&gt;,task_priority优先级越高，优先执行（zset）" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;fontFamily=Helvetica;fontColor=#000000;" parent="hdSKTdFJiRucH8Rsu3lH-64" vertex="1">
          <mxGeometry y="236.58" width="860" height="273.42" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-63" value="create_detector_tasks(detector/manager.py)&lt;br&gt;create_detector_tasks_with_sync_to_queue&lt;br&gt;1、删除之前的鉴定结果（delete &lt;font color=&quot;#ff6666&quot;&gt;t_detector_result&lt;/font&gt; by md5）&lt;br&gt;2、获取所有的鉴定器id&lt;br&gt;3、（忽略没有鉴定器的情况）create_detector_tasks_with_sync_to_queue先根据md5移除再创建扫描任务数据保存到MongDB的&lt;font color=&quot;#0000ff&quot;&gt;kcs_scan_task&lt;/font&gt;表&lt;br&gt;4、同步任务到Redis优先级队列（大于20M的bigfile=true）&lt;br&gt;队列&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;&lt;span style=&quot;font-size: 24px&quot;&gt;id=scanner_id+kcs_scan&lt;/span&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;_task+&lt;/font&gt;&lt;/font&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-size: 24px&quot;&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;bigfile&lt;/font&gt;&lt;/span&gt;&lt;font color=&quot;#00cc00&quot;&gt;&lt;br&gt;&lt;/font&gt;task_priority优先级越高，优先执行（zset）" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;fontFamily=Helvetica;fontColor=#000000;" parent="hdSKTdFJiRucH8Rsu3lH-64" vertex="1">
          <mxGeometry width="860" height="260.98967141209744" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-65" value="更新&lt;font color=&quot;#ff6666&quot;&gt;t_sample_elapsed_time&lt;/font&gt;表杀软、鉴定器任务开始时间" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;align=left;" parent="LtVPb9jL59xOHaWL_HOs-47" vertex="1">
          <mxGeometry y="637.1765650206078" width="860" height="69.37343497939192" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-76" value="&lt;div&gt;优先级大于0的直接创建杀软回扫任务和鉴定器回扫&lt;span&gt;任务，没有优先级的需要判断MongDB中的&lt;/span&gt;&lt;/div&gt;&lt;span style=&quot;color: rgb(0 , 0 , 255)&quot;&gt;av_rescan_task、kcs_rescan_task&lt;/span&gt;&lt;span&gt;任务数是否都超过10万，是则不创建杀软扫描任务和鉴定器任务，更新&lt;/span&gt;&lt;font color=&quot;#ff3333&quot;&gt;t_sample_elapsed_time &lt;/font&gt;&lt;span&gt;表的错误码&lt;/span&gt;&lt;span style=&quot;color: rgb(0 , 0 , 255)&quot;&gt;&lt;br&gt;&lt;/span&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;align=left;" parent="1" vertex="1">
          <mxGeometry x="213" y="1650" width="860" height="140" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-72" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="213" y="1790" width="860" height="420" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-73" value="&lt;font face=&quot;helvetica&quot;&gt;rescan_create_scanner_tasks&lt;/font&gt;(safescan\manager.py)&lt;br&gt;create_scanner_tasks_with_sync_to_queue&lt;br&gt;1、删除病毒样本任务（delete&lt;font color=&quot;#ff3333&quot;&gt; t_virus_sample_task/t_virus_sample_big_text&lt;/font&gt; by md5）&lt;br&gt;2、获取所有的杀软id&lt;br&gt;3、（忽略没有杀软的情况）create_tasks_with_sync_to_queues先根据md5移除再创建扫描任务数据保存到MongDB的&lt;span style=&quot;font-family: &amp;#34;helvetica&amp;#34;&quot;&gt;&lt;font color=&quot;#0000ff&quot;&gt;av_rescan_task&lt;/font&gt;&lt;/span&gt;表&lt;br&gt;4、把扫描任务同步到Redis优先级队列" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;fontFamily=Helvetica;fontColor=#000000;" parent="hdSKTdFJiRucH8Rsu3lH-72" vertex="1">
          <mxGeometry y="205.8" width="860" height="214.20000000000002" as="geometry" />
        </mxCell>
        <mxCell id="hdSKTdFJiRucH8Rsu3lH-74" value="rescan_create_detector_tasks(detector/manager.py)&lt;br&gt;create_detector_tasks_with_sync_to_queue&lt;br&gt;1、删除之前的鉴定结果（delete &lt;font color=&quot;#ff6666&quot;&gt;t_detector_result&lt;/font&gt; by md5）&lt;br&gt;2、获取所有的鉴定器id&lt;br&gt;3、（忽略没有鉴定器的情况）create_detector_tasks_with_sync_to_queue先根据md5把任务删掉再把任务数据保存到MongDB的&lt;font color=&quot;#0000ff&quot;&gt;kcs_rescan_task&lt;/font&gt;表&lt;br&gt;4、鉴定任务同步任务到Redis优先级队列id=&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;scanner_id+&lt;/font&gt;&lt;font color=&quot;#00cc00&quot;&gt;kcs_rescan_task&lt;/font&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;+&lt;/font&gt;&lt;font color=&quot;#00cc00&quot; style=&quot;font-size: 24px&quot;&gt;bigfile&lt;/font&gt;&lt;br&gt;，优先级越高，优先执行（zset）" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=22;align=left;fontFamily=Helvetica;fontColor=#000000;" parent="hdSKTdFJiRucH8Rsu3lH-72" vertex="1">
          <mxGeometry width="860" height="220" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-48" value="更新&lt;font color=&quot;#ff6666&quot;&gt;t_sample_elapsed_time&lt;/font&gt;表杀软和鉴定器任务开始时间" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=22;fontColor=#000000;align=left;" parent="1" vertex="1">
          <mxGeometry x="213" y="2200" width="860" height="60" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-54" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="LtVPb9jL59xOHaWL_HOs-50" target="LtVPb9jL59xOHaWL_HOs-53" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-50" value="&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;microsoft yahei ui&amp;#34;&quot;&gt;scanresultsaver.py扫描结果处理run()&lt;br&gt;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;microsoft yahei ui&amp;#34;&quot;&gt;basescanresultsaver.py -&amp;gt;save_scan_results()&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-family: &amp;#34;microsoft yahei ui&amp;#34;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;span&gt;1、查杀完后，将扫描结果的开始、结束时间、&lt;/span&gt;批次，杀软，扫描病毒等信息保存到数据库rpc调用&lt;span style=&quot;font-family: &amp;#34;dejavu sans mono&amp;#34; , monospace&quot;&gt;save_scan_result()&lt;/span&gt;&lt;br&gt;&lt;br&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1960" y="2030" width="820" height="170" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-59" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="LtVPb9jL59xOHaWL_HOs-53" target="LtVPb9jL59xOHaWL_HOs-58" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-53" value="&lt;font style=&quot;font-size: 24px&quot;&gt;&lt;font style=&quot;font-size: 24px&quot;&gt;safescan/&lt;/font&gt;manager.py&lt;br&gt;1、save_scan_result保存数据到&lt;font color=&quot;#ff6666&quot;&gt;t_virus_sample_task&lt;/font&gt;表&lt;br&gt;2、如果是信息比较大保存数据到&lt;font color=&quot;#ff6666&quot;&gt;t_virus_sample_big_text&lt;/font&gt;表&lt;br&gt;3、finish_redis_task（）将结果数据保存到MongDB的&lt;font color=&quot;#0000ff&quot;&gt;av_scan_task&lt;/font&gt;然后备份到&lt;font color=&quot;#0000ff&quot;&gt;av_scan_task_backup&lt;/font&gt;表，在从&lt;font color=&quot;#0000ff&quot;&gt;av_scan_task&lt;/font&gt;删除&lt;br&gt;4、最后把样本的md5的数据从队列移除&lt;font color=&quot;#00cc00&quot;&gt;scanning_queue:{md5}&lt;/font&gt;&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;hachureGap=4;pointerEvents=0;fontSize=24;align=left;fontFamily=Helvetica;fontColor=default;fillColor=#FFFFFF;strokeColor=#000000;labelBackgroundColor=default;" parent="1" vertex="1">
          <mxGeometry x="-1960" y="2240" width="820" height="200" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;fontFamily=Helvetica;fontSize=24;fontColor=default;dashed=1;" parent="1" source="hdSKTdFJiRucH8Rsu3lH-74" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-979" y="1810" as="targetPoint" />
            <Array as="points">
              <mxPoint x="213" y="1560" />
              <mxPoint x="-979" y="1560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-57" value="类似流程，逻辑不同，原理都差不多" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=24;fontFamily=Helvetica;fontColor=default;" parent="LtVPb9jL59xOHaWL_HOs-56" vertex="1" connectable="0">
          <mxGeometry x="0.4873" y="-5" relative="1" as="geometry">
            <mxPoint x="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-58" value="结束" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#FF6666;align=center;" parent="1" vertex="1">
          <mxGeometry x="-1590" y="2470" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-61" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="LtVPb9jL59xOHaWL_HOs-60" target="LtVPb9jL59xOHaWL_HOs-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-60" value="开始" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#97D077;align=center;" parent="1" vertex="1">
          <mxGeometry x="-1590" y="1500" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-64" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontFamily=Helvetica;fontSize=24;fontColor=default;" parent="1" source="LtVPb9jL59xOHaWL_HOs-62" target="hdSKTdFJiRucH8Rsu3lH-136" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-62" value="开始" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;hachureGap=4;pointerEvents=0;fontFamily=Helvetica;fontSize=24;fontColor=#000000;fillColor=#97D077;align=center;" parent="1" vertex="1">
          <mxGeometry x="-2721" y="1473" width="80" height="80" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-67" value="杀软扫描流程" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=default;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="-1670" y="1410" width="240" height="40" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-76" value="" style="group;fontStyle=1" parent="1" vertex="1" connectable="0">
          <mxGeometry x="-2820" y="30" width="990" height="260" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-73" value="&lt;font color=&quot;#000000&quot;&gt;&amp;nbsp; 文字颜色说明：&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=#0000FF;align=left;fontStyle=1" parent="LtVPb9jL59xOHaWL_HOs-76" vertex="1">
          <mxGeometry width="990.0000000000002" height="260" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-70" value="红色的内容是mysql数据库表" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=#FF6666;fontStyle=1" parent="LtVPb9jL59xOHaWL_HOs-76" vertex="1">
          <mxGeometry x="273.5526315789474" y="31.200000000000003" width="638.2894736842107" height="20.8" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-71" value="绿色的内容是redis队列或者key" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=#00CC00;fontStyle=1" parent="LtVPb9jL59xOHaWL_HOs-76" vertex="1">
          <mxGeometry x="273.5526315789474" y="124.80000000000001" width="638.2894736842107" height="20.8" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-72" value="蓝色部分是mongdb的表名" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;labelBackgroundColor=default;fontFamily=Helvetica;fontSize=35;fontColor=#0000FF;fontStyle=1" parent="LtVPb9jL59xOHaWL_HOs-76" vertex="1">
          <mxGeometry x="273.5526315789474" y="208.00000000000003" width="638.2894736842107" height="20.8" as="geometry" />
        </mxCell>
        <mxCell id="LtVPb9jL59xOHaWL_HOs-78" value="" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.4;arrowSize=0.4;rounded=0;fontSize=22;align=left;hachureGap=4;" parent="1" vertex="1">
          <mxGeometry x="-960" y="158" width="80" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
